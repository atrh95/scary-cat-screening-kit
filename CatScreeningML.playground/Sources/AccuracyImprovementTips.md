# 機械学習モデル精度改善のヒント

`CreateML` を用いた画像分類モデルの精度向上 Tips です。

## 1. データは量と質、多様性が重要

### データ品質の向上
質の低いデータは精度低下を招きます。
- **高品質な画像:** クリアで特徴が分かりやすい画像を選びます（低解像度、手ブレ等は避ける）。
- **正確なラベル付け:** ラベル間違いは学習の妨げになるため、慎重に確認します。
- **曖昧な画像の扱い:** 判断に迷う画像は除外するか、クラス定義の見直し（明確化や中間クラス設定）を検討します。

### データバランスとクリーニング
クラス間のデータ数（枚数）の偏りは、モデル性能に影響します。可能な限り数を揃えるのが理想ですが、難しい場合はデータ拡張や評価指標の工夫で対処します。
定期的なデータクリーニング（低品質・ラベル間違い・曖昧画像の修正/除外）も重要です。

### データ拡張 (Data Augmentation)
既存画像を加工（回転、反転等）して擬似的に増やし、モデルの汎化性能を高める手法です。
`CreateML` では `augmentation` パラメータで利用できます。ただし、拡張の種類がタスクに不適切だと逆効果になることも。シンプルな拡張から試すなど、タスクに合わせた試行錯誤が有効です。（例: このプロジェクトでは多くの拡張を組み合わせても効果は限定的でした）

## 2. トレーニングの工夫

`CreateML` は多くを自動化しますが、調整も可能です。

### パラメータ調整
`MLImageClassifier.ModelParameters` で調整できます。例えば `maxIterations` （最大反復回数）がありますが、固定値よりデフォルトの自動調整が良い場合もあります（特にデータ拡張時、このプロジェクトでもそうでした）。他のパラメータ（`featureExtractor`等）も確認・試行の価値があります。
（※ `ScaryCatScreenerTrainer` で調整するには初期化部分を変更）

### 過学習 (Overfitting) の監視
トレーニングデータでの精度は高いが、未知の検証データで低い場合、過学習（データを暗記して汎用性を失った状態）が疑われます。トレーニング/検証エラー率の差で判断できます。
対策は、データ量増加（特に多様なデータ）、データ拡張、正則化（パラメータがあれば）などです。

## 3. その他のヒント
- **特徴抽出器の変更:** `featureExtractor` パラメータで内部モデルを変更し、精度改善を試みることができます。
- **問題設定の見直し:** タスク自体が難しすぎる場合、クラス定義の変更や問題の単純化も有効です。
